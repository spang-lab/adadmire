# Based on: https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-python#publishing-to-package-registries
name: Deploy
on: {release: {types: [published]}}
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - {name: Checkout repo, uses: actions/checkout@v4}
    - {name: Setup python, uses: actions/setup-python@v4, with: {python-version: "3.x"}}
    - {name: Install deps, run: "python3 -m pip install build --user"}
    - {name: Build adadmire, run: "python3 -m build"}
    - {name: Store package, uses: actions/upload-artifact@v3, with: {name: python-package-distributions, path: dist/}}
  deploy:
    runs-on: ubuntu-latest
    environment: {name: pypi, url: https://pypi.org/p/adadmire}
    steps:
    - {name: Download package, uses: actions/download-artifact@v3, with: {name: python-package-distributions, path: dist/}}
    - {name: Publish to PyPI, uses: pypa/gh-action-pypi-publish@release/v1}


